<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Sheets Submission Test (CORS Safe)</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; }
    form { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, button {
      width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 4px; border: 1px solid #ccc;
    }
    button {
      background-color: #2ecc71; color: white; font-weight: bold;
      border: none; cursor: pointer; margin-top: 20px;
    }
    button:hover {
      background-color: #27ae60;
    }
  </style>
</head>
<body>
  <form id="testForm">
    <h2>Test Submission to Google Sheet</h2>

    <label for="currencyPair">Currency Pair</label>
    <input type="text" id="currencyPair" required>

    <label for="lotSize">Lot Size</label>
    <input type="number" step="0.01" id="lotSize" required>

    <label for="entryPrice">Entry Price</label>
    <input type="number" step="0.00001" id="entryPrice" required>

    <label for="stopLoss">Stop Loss</label>
    <input type="number" step="0.00001" id="stopLoss" required>

    <label for="takeProfit">Take Profit</label>
    <input type="number" step="0.00001" id="takeProfit">

    <label for="tradeType">Trade Type</label>
    <select id="tradeType">
      <option value="buy">Buy</option>
      <option value="sell">Sell</option>
    </select>

    <button type="submit">Submit</button>
  </form>

  <script>
    function getCurrentDate() {
      const today = new Date();
      const day = String(today.getDate()).padStart(2, '0');
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const year = today.getFullYear();
      return `${day}/${month}/${year}`;
    }

    document.getElementById("testForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const formData = new FormData();
      formData.append("date", getCurrentDate());
      formData.append("pair", document.getElementById("currencyPair").value);
      formData.append("lotSize", document.getElementById("lotSize").value);
      formData.append("entryPrice", document.getElementById("entryPrice").value);
      formData.append("stopLossPrice", document.getElementById("stopLoss").value);
      formData.append("takeProfitPrice", document.getElementById("takeProfit").value || "Not set");
      formData.append("tradeType", document.getElementById("tradeType").value);

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbyL-Q3VRlWjyCw8cn96gmNZocq26Du12KKsAUvWVipONIct-DIPwxxwmZpruZgIFw_z/exec", {
          method: "POST",
          body: formData
        });

        const resultText = await response.text();
        alert(resultText.includes("Success") ? "Form submitted successfully!" : "Submission failed.");
      } catch (error) {
        console.error("Error submitting form:", error);
        alert("There was an error submitting the form.");
      }
    });
  </script>
</body>
</html>
