<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Submit Trade to Google Sheet</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    form { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, button {
      width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 4px; border: 1px solid #ccc;
    }
    button {
      background-color: #2ecc71; color: white; font-weight: bold;
      border: none; cursor: pointer; margin-top: 20px;
    }
    button:hover {
      background-color: #27ae60;
    }
    .message {
      margin-top: 20px;
      text-align: center;
      font-weight: bold;
    }
    .error {
      color: #e74c3c;
    }
    .success {
      color: #2ecc71;
    }
  </style>
</head>
<body>

  <form id="tradeForm">
    <h2>Submit Trade Data</h2>

    <label for="pair">Currency Pair</label>
    <input type="text" name="pair" id="pair" required value="EURUSD">

    <label for="lotSize">Lot Size</label>
    <input type="number" step="0.01" name="lotSize" id="lotSize" required value="0.1">

    <label for="entryPrice">Entry Price</label>
    <input type="number" step="0.00001" name="entryPrice" id="entryPrice" required value="1.0850">

    <label for="stopLossPrice">Stop Loss</label>
    <input type="number" step="0.00001" name="stopLossPrice" id="stopLossPrice" required value="1.0800">

    <label for="takeProfitPrice">Take Profit</label>
    <input type="number" step="0.00001" name="takeProfitPrice" id="takeProfitPrice" value="1.0950">

    <label for="tradeType">Trade Type</label>
    <select name="tradeType" id="tradeType">
      <option value="BUY">Buy</option>
      <option value="SELL">Sell</option>
    </select>

    <button type="submit">Submit</button>
    <div class="message" id="confirmationMessage"></div>
  </form>

  <script>
    document.getElementById('tradeForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const messageElement = document.getElementById('confirmationMessage');
      messageElement.textContent = "Submitting...";
      messageElement.className = "message";
      
      try {
        // Prepare form data
        const formData = {
          pair: document.getElementById('pair').value,
          lotSize: document.getElementById('lotSize').value,
          entryPrice: document.getElementById('entryPrice').value,
          stopLossPrice: document.getElementById('stopLossPrice').value,
          takeProfitPrice: document.getElementById('takeProfitPrice').value || '',
          tradeType: document.getElementById('tradeType').value
        };

        // Add timestamp to URL to prevent caching
        const url = new URL("https://script.google.com/macros/s/AKfycbyL-Q3VRlWjyCw8cn96gmNZocq26Du12KKsAUvWVipONIct-DIPwxxwmZpruZgIFw_z/exec");
        url.searchParams.append('t', Date.now());

        // Append form data to URL as parameters
        for (const key in formData) {
          url.searchParams.append(key, formData[key]);
        }

        // Submit the data
        const response = await fetch(url, {
          method: 'POST',
          redirect: 'follow'
        });

        const result = await response.text();
        
        if (result.includes("Success")) {
          messageElement.textContent = "✅ Form submitted successfully!";
          messageElement.className = "message success";
          document.getElementById("tradeForm").reset();
        } else {
          messageElement.textContent = "⚠️ Submission completed but no data received";
          messageElement.className = "message error";
        }
      } catch (error) {
        messageElement.textContent = `❌ Error: ${error.message}`;
        messageElement.className = "message error";
        console.error("Submission error:", error);
      }
    });
  </script>

</body>
</html>
